# テスト追加の進め方（今後の方針メモ）

## 基本方針
- **背骨から外周へ**: 代表フロー（商品一覧→詳細→カート→表示）を起点に広げる
- **速い安全網から足す**: 小さいユニット→実I/O統合→E2Eの順で追加

## 追加の流れ（1機能あたり）
1. 触る関数・分岐に **ユニットテスト** を1本（Vitest）
2. I/Oや実DBが絡むなら **統合テスト** を1本（モックでなく実データ）
3. 背骨に関わるなら **E2E** に1ステップ追加（安定セレクタ・適切な待機）
4. 安定した領域から、該当ジョブを **PRゲートに昇格**（手動→自動）

## 粒度の目安
- 30分で書ける最小ケースを1本
- 代表例（正常）＋境界1つ（異常）を目安に小さく足す
- 長大なテストは関数単位で分割し、読みやすさ優先

## 実行ワークフローとの対応
- **ユニット/統合**: `ci.yml` の test（ゲート）
- **E2E**: `e2e.yml` 手動。安定したらPRゲート昇格を検討
- **型/ビルド**: 現在は手動（`typecheck.yml` / `build.yml`）。直した領域から段階的にゲートへ戻す

## 背景
- いまは lint 非ブロック、typecheck・build は手動運用（ソース未修正のエラーが残存するため）
- テストを足しつつ、安定したところからゲートに戻し、最終的に自動化を広げていく

